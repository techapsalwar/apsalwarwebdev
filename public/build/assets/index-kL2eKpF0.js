import{c as ds,d as hs,r as G,j as s,a as q,H as xs,L as ze}from"./app-Cmq9oDGi.js";import{T as ps,f as fs,g as gs,h as us,D as js,a as bs,b as Ss,e as we,d as ys,A as _s}from"./app-layout-DoVO_vzw.js";import{c as ls,B as m}from"./button-Cf4oe_XG.js";import{I as vs}from"./input-CJJo5L_5.js";import{B as Ge}from"./badge-B7t43j3u.js";import{C as Ns}from"./checkbox-CKQ6FKwl.js";import{b as Be,e as O,a as ks,c as X,T as Cs,d as ws}from"./table-DxHlWMmR.js";import{c as Ds,d as Ps,a as rs,S as Ts,b as Us}from"./select-MDq58P37.js";import{D as Oe,b as Xe,a as qe,c as Ke,d as Je,e as Qe}from"./dialog-BBiXcngs.js";import{c as We,d as Ye,C as As,a as Ms,b as Is}from"./card-X8yrq1E7.js";import{S as Rs}from"./separator-5_1D4i4m.js";import{U as $s,S as Ze,X as Es}from"./x-HfyhX8Ju.js";import{P as Ls}from"./plus-CX2v85UT.js";import{S as es}from"./search-CM4xpWys.js";import{S as ss}from"./shield-check-CIirHjii.js";import{L as Fs}from"./lock-BNj5CUXT.js";import{P as Bs}from"./pencil-DNgxEyTx.js";import{U as Hs}from"./user-cog-Bzv9NNGa.js";import{T as ts}from"./trash-2-DfEL4ZSA.js";import{I as Vs}from"./info-B6SLcbN-.js";import{S as zs}from"./save-CXYQgcZY.js";/* empty css            */import"./index-CWF-aD8F.js";import"./index-uM6iNYTc.js";import"./index-7JW2xj0O.js";import"./index-DyFFqtbr.js";import"./Combination-NTvMx_hL.js";import"./index-BZSQ9xrA.js";import"./index-DvAkvJaB.js";import"./index-CJXivgjO.js";import"./index-C9wRH-1q.js";import"./index-D_u97ceG.js";import"./index-BQQBJX9w.js";import"./index-CghxG9km.js";import"./avatar-XGiuVYGe.js";import"./index-Caa2gN9W.js";import"./index-DHA2i0B2.js";import"./image-DO4yfKR-.js";import"./link-CZ3Nda4c.js";import"./quote-RHalnNgg.js";import"./newspaper-BNdRHAAi.js";import"./megaphone-D5LK33hs.js";import"./indian-rupee-n2MNJtU2.js";import"./file-check-Cs6It4z_.js";import"./folder-B56i9kPD.js";import"./handshake-TJFmC-Ix.js";import"./school-D_aABbcu.js";import"./index-CJgzQKWL.js";import"./check-z4pC7DcM.js";import"./chevron-up-08YVdQiA.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Os=ls("EllipsisVertical",Gs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]],qs=ls("ShieldX",Xs);function Yt(r){const e=ds.c(111),{users:p,permissions:o,roles:De,groupedModules:f,filters:He}=r,{flash:d}=hs().props,[n,as]=G.useState(He.search||""),[g,is]=G.useState(He.role||""),[u,K]=G.useState(null),[j,J]=G.useState(null);let Q;e[0]===Symbol.for("react.memo_cache_sentinel")?(Q=[],e[0]=Q):Q=e[0];const[a,W]=G.useState(Q),[Y,Pe]=G.useState(!1);let Z;e[1]!==g||e[2]!==n?(Z=()=>{const l=new URLSearchParams;n&&l.set("search",n),g&&g!=="all"&&l.set("role",g),q.get(`/admin/users?${l.toString()}`,{},{preserveState:!0})},e[1]=g,e[2]=n,e[3]=Z):Z=e[3];const b=Z;let ee;e[4]!==n?(ee=l=>{is(l);const t=new URLSearchParams;n&&t.set("search",n),l&&l!=="all"&&t.set("role",l),q.get(`/admin/users?${t.toString()}`,{},{preserveState:!0})},e[4]=n,e[5]=ee):ee=e[5];const Te=ee;let se;e[6]===Symbol.for("react.memo_cache_sentinel")?(se=l=>{const t=l.permissions.map(st);W(t),J(l)},e[6]=se):se=e[6];const Ve=se;let te;e[7]===Symbol.for("react.memo_cache_sentinel")?(te=l=>{W(t=>t.includes(l)?t.filter(i=>i!==l):[...t,l])},e[7]=te):te=e[7];const ns=te;let le;e[8]!==f||e[9]!==a?(le=l=>{const t=f[l].map(et),i=t.every(c=>a.includes(c));W(i?c=>c.filter(x=>!t.includes(x)):c=>[...new Set([...c,...t])])},e[8]=f,e[9]=a,e[10]=le):le=e[10];const Ue=le;let re;e[11]!==j||e[12]!==a?(re=()=>{j&&(Pe(!0),q.post(`/admin/users/${j.id}/permissions`,{permissions:a},{onSuccess:()=>{J(null),Pe(!1)},onError:()=>Pe(!1)}))},e[11]=j,e[12]=a,e[13]=re):re=e[13];const Ae=re;let ae;e[14]!==u?(ae=()=>{u&&q.delete(`/admin/users/${u.id}`,{onSuccess:()=>K(null)})},e[14]=u,e[15]=ae):ae=e[15];const Me=ae,cs=Zs,os=Ys;let ie;e[16]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx(xs,{title:"User Management"}),e[16]=ie):ie=e[16];let ne;e[17]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold tracking-tight flex items-center gap-2",children:[s.jsx($s,{className:"h-6 w-6"}),"User Management"]}),s.jsx("p",{className:"text-muted-foreground",children:"Manage users and their module-level permissions"})]}),e[17]=ne):ne=e[17];let ce;e[18]===Symbol.for("react.memo_cache_sentinel")?(ce=s.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[ne,s.jsx(m,{asChild:!0,children:s.jsxs(ze,{href:"/admin/users/create",children:[s.jsx(Ls,{className:"mr-2 h-4 w-4"}),"Add User"]})})]}),e[18]=ce):ce=e[18];let S;e[19]!==d?(S=d?.success&&s.jsx("div",{className:"rounded-lg bg-green-50 p-4 text-green-700 dark:bg-green-900/20 dark:text-green-400",children:d.success}),e[19]=d,e[20]=S):S=e[20];let y;e[21]!==d?(y=d?.error&&s.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-red-700 dark:bg-red-900/20 dark:text-red-400",children:d.error}),e[21]=d,e[22]=y):y=e[22];let oe;e[23]===Symbol.for("react.memo_cache_sentinel")?(oe=s.jsx(es,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e[23]=oe):oe=e[23];let me;e[24]===Symbol.for("react.memo_cache_sentinel")?(me=l=>as(l.target.value),e[24]=me):me=e[24];let _;e[25]!==b?(_=l=>l.key==="Enter"&&b(),e[25]=b,e[26]=_):_=e[26];let v;e[27]!==n||e[28]!==_?(v=s.jsxs("div",{className:"relative flex-1",children:[oe,s.jsx(vs,{placeholder:"Search by name or email...",value:n,onChange:me,onKeyDown:_,className:"pl-9"})]}),e[27]=n,e[28]=_,e[29]=v):v=e[29];const Ie=g||"all";let de;e[30]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsx(Ds,{className:"w-[180px]",children:s.jsx(Ps,{placeholder:"Filter by role"})}),e[30]=de):de=e[30];let he;e[31]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx(rs,{value:"all",children:"All Roles"}),e[31]=he):he=e[31];let N;e[32]!==De?(N=De.map(Qs),e[32]=De,e[33]=N):N=e[33];let k;e[34]!==N?(k=s.jsxs(Ts,{children:[he,N]}),e[34]=N,e[35]=k):k=e[35];let C;e[36]!==Te||e[37]!==Ie||e[38]!==k?(C=s.jsxs(Us,{value:Ie,onValueChange:Te,children:[de,k]}),e[36]=Te,e[37]=Ie,e[38]=k,e[39]=C):C=e[39];let xe;e[40]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx(es,{className:"mr-2 h-4 w-4"}),e[40]=xe):xe=e[40];let w;e[41]!==b?(w=s.jsxs(m,{onClick:b,variant:"secondary",children:[xe,"Search"]}),e[41]=b,e[42]=w):w=e[42];let D;e[43]!==v||e[44]!==C||e[45]!==w?(D=s.jsx(We,{children:s.jsx(Ye,{className:"pt-6",children:s.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center",children:[v,C,w]})})}),e[43]=v,e[44]=C,e[45]=w,e[46]=D):D=e[46];let pe;e[47]===Symbol.for("react.memo_cache_sentinel")?(pe=s.jsxs(As,{children:[s.jsx(Ms,{children:"Users"}),s.jsx(Is,{children:"Click the shield icon to manage module-level permissions for each user"})]}),e[47]=pe):pe=e[47];let fe;e[48]===Symbol.for("react.memo_cache_sentinel")?(fe=s.jsx(ks,{children:s.jsxs(Be,{children:[s.jsx(X,{children:"User"}),s.jsx(X,{children:"Role"}),s.jsx(X,{children:"Permissions"}),s.jsx(X,{children:"Status"}),s.jsx(X,{className:"text-right",children:"Actions"})]})}),e[48]=fe):fe=e[48];let P;if(e[49]!==o.length||e[50]!==p.data){let l;e[52]!==o.length?(l=t=>{const i=t.roles.some(Js),c=i?o.length:t.permissions.length;return s.jsxs(Be,{children:[s.jsx(O,{children:s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:t.name}),s.jsx("div",{className:"text-sm text-muted-foreground",children:t.email})]})}),s.jsx(O,{children:t.roles.map(x=>s.jsxs(Ge,{className:os(x.name),children:[x.name==="super_admin"&&s.jsx(ss,{className:"mr-1 h-3 w-3"}),x.name.replace("_"," ")]},x.id))}),s.jsx(O,{children:s.jsx(ps,{children:s.jsxs(fs,{children:[s.jsx(gs,{asChild:!0,children:s.jsxs(m,{variant:"outline",size:"sm",onClick:()=>Ve(t),disabled:i,children:[i?s.jsx(Fs,{className:"mr-1 h-3 w-3"}):s.jsx(Ze,{className:"mr-1 h-3 w-3"}),c," / ",o.length]})}),s.jsx(us,{children:i?"Super Admin has all permissions":"Click to manage permissions"})]})})}),s.jsx(O,{children:s.jsx(Ge,{variant:t.is_active?"default":"secondary",className:t.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:t.is_active?"Active":"Inactive"})}),s.jsx(O,{className:"text-right",children:s.jsxs(js,{children:[s.jsx(bs,{asChild:!0,children:s.jsx(m,{variant:"ghost",size:"sm",children:s.jsx(Os,{className:"h-4 w-4"})})}),s.jsxs(Ss,{align:"end",children:[s.jsx(we,{asChild:!0,children:s.jsxs(ze,{href:`/admin/users/${t.id}/edit`,children:[s.jsx(Bs,{className:"mr-2 h-4 w-4"}),"Edit"]})}),s.jsxs(we,{onClick:()=>Ve(t),disabled:i,children:[s.jsx(Hs,{className:"mr-2 h-4 w-4"}),"Permissions"]}),s.jsx(we,{onClick:()=>cs(t),children:t.is_active?s.jsxs(s.Fragment,{children:[s.jsx(qs,{className:"mr-2 h-4 w-4"}),"Deactivate"]}):s.jsxs(s.Fragment,{children:[s.jsx(ss,{className:"mr-2 h-4 w-4"}),"Activate"]})}),s.jsx(ys,{}),s.jsxs(we,{className:"text-destructive",onClick:()=>K(t),children:[s.jsx(ts,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},t.id)},e[52]=o.length,e[53]=l):l=e[53],P=p.data.map(l),e[49]=o.length,e[50]=p.data,e[51]=P}else P=e[51];let T;e[54]!==p.data.length?(T=p.data.length===0&&s.jsx(Be,{children:s.jsx(O,{colSpan:5,className:"text-center py-8",children:s.jsx("div",{className:"text-muted-foreground",children:"No users found"})})}),e[54]=p.data.length,e[55]=T):T=e[55];let U;e[56]!==P||e[57]!==T?(U=s.jsxs(We,{children:[pe,s.jsx(Ye,{children:s.jsxs(Cs,{children:[fe,s.jsxs(ws,{children:[P,T]})]})})]}),e[56]=P,e[57]=T,e[58]=U):U=e[58];const Re=!!j;let ge;e[59]===Symbol.for("react.memo_cache_sentinel")?(ge=()=>J(null),e[59]=ge):ge=e[59];let ue;e[60]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsx(Ze,{className:"h-5 w-5"}),e[60]=ue):ue=e[60];const $e=j?.name;let A;e[61]!==$e?(A=s.jsxs(Oe,{className:"flex items-center gap-2",children:[ue,"Manage Permissions: ",$e]}),e[61]=$e,e[62]=A):A=e[62];let je;e[63]===Symbol.for("react.memo_cache_sentinel")?(je=s.jsx(Xe,{children:"Select which admin modules this user can access."}),e[63]=je):je=e[63];let M;e[64]!==A?(M=s.jsxs(qe,{children:[A,je]}),e[64]=A,e[65]=M):M=e[65];let I;e[66]!==f||e[67]!==a||e[68]!==Ue?(I=s.jsx("div",{className:"space-y-6 py-4",children:Object.entries(f).map(l=>{const[t,i]=l,c=i.map(Ks),ms=c.filter(h=>a.includes(h)).length===c.length;return s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"font-semibold text-sm uppercase tracking-wide text-muted-foreground",children:t}),s.jsx(m,{variant:"ghost",size:"sm",onClick:()=>Ue(t),children:ms?"Deselect All":"Select All"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:i.map(h=>s.jsxs("label",{className:`flex items-start gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${a.includes(h.key)?"bg-primary/5 border-primary":"hover:bg-muted/50"}`,children:[s.jsx(Ns,{checked:a.includes(h.key),onCheckedChange:()=>ns(h.key)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium text-sm",children:h.name}),s.jsx("div",{className:"text-xs text-muted-foreground truncate",children:h.description})]})]},h.key))}),s.jsx(Rs,{})]},t)})}),e[66]=f,e[67]=a,e[68]=Ue,e[69]=I):I=e[69];let be;e[70]===Symbol.for("react.memo_cache_sentinel")?(be=s.jsx(Vs,{className:"h-4 w-4"}),e[70]=be):be=e[70];let R;e[71]!==o.length||e[72]!==a.length?(R=s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mr-auto",children:[be,a.length," of ",o.length," modules selected"]}),e[71]=o.length,e[72]=a.length,e[73]=R):R=e[73];let Se;e[74]===Symbol.for("react.memo_cache_sentinel")?(Se=s.jsxs(m,{variant:"outline",onClick:()=>J(null),children:[s.jsx(Es,{className:"mr-2 h-4 w-4"}),"Cancel"]}),e[74]=Se):Se=e[74];let ye;e[75]===Symbol.for("react.memo_cache_sentinel")?(ye=s.jsx(zs,{className:"mr-2 h-4 w-4"}),e[75]=ye):ye=e[75];const Ee=Y?"Saving...":"Save Permissions";let $;e[76]!==Ae||e[77]!==Y||e[78]!==Ee?($=s.jsxs(m,{onClick:Ae,disabled:Y,children:[ye,Ee]}),e[76]=Ae,e[77]=Y,e[78]=Ee,e[79]=$):$=e[79];let E;e[80]!==R||e[81]!==$?(E=s.jsxs(Ke,{children:[R,Se,$]}),e[80]=R,e[81]=$,e[82]=E):E=e[82];let L;e[83]!==M||e[84]!==I||e[85]!==E?(L=s.jsxs(Je,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[M,I,E]}),e[83]=M,e[84]=I,e[85]=E,e[86]=L):L=e[86];let F;e[87]!==Re||e[88]!==L?(F=s.jsx(Qe,{open:Re,onOpenChange:ge,children:L}),e[87]=Re,e[88]=L,e[89]=F):F=e[89];const Le=!!u;let _e;e[90]===Symbol.for("react.memo_cache_sentinel")?(_e=()=>K(null),e[90]=_e):_e=e[90];let ve;e[91]===Symbol.for("react.memo_cache_sentinel")?(ve=s.jsx(Oe,{children:"Delete User"}),e[91]=ve):ve=e[91];const Fe=u?.name;let B;e[92]!==Fe?(B=s.jsxs(qe,{children:[ve,s.jsxs(Xe,{children:["Are you sure you want to delete"," ",s.jsx("span",{className:"font-semibold",children:Fe}),"? This action cannot be undone."]})]}),e[92]=Fe,e[93]=B):B=e[93];let Ne;e[94]===Symbol.for("react.memo_cache_sentinel")?(Ne=s.jsx(m,{variant:"outline",onClick:()=>K(null),children:"Cancel"}),e[94]=Ne):Ne=e[94];let ke;e[95]===Symbol.for("react.memo_cache_sentinel")?(ke=s.jsx(ts,{className:"mr-2 h-4 w-4"}),e[95]=ke):ke=e[95];let H;e[96]!==Me?(H=s.jsxs(Ke,{children:[Ne,s.jsxs(m,{variant:"destructive",onClick:Me,children:[ke,"Delete"]})]}),e[96]=Me,e[97]=H):H=e[97];let V;e[98]!==B||e[99]!==H?(V=s.jsxs(Je,{children:[B,H]}),e[98]=B,e[99]=H,e[100]=V):V=e[100];let z;e[101]!==Le||e[102]!==V?(z=s.jsx(Qe,{open:Le,onOpenChange:_e,children:V}),e[101]=Le,e[102]=V,e[103]=z):z=e[103];let Ce;return e[104]!==S||e[105]!==y||e[106]!==D||e[107]!==U||e[108]!==F||e[109]!==z?(Ce=s.jsxs(_s,{children:[ie,s.jsxs("div",{className:"space-y-6",children:[ce,S,y,D,U,F,z]})]}),e[104]=S,e[105]=y,e[106]=D,e[107]=U,e[108]=F,e[109]=z,e[110]=Ce):Ce=e[110],Ce}function Ks(r){return r.key}function Js(r){return r.name==="super_admin"}function Qs(r){return s.jsx(rs,{value:r.name,children:r.name.replace("_"," ").replace(/\b\w/g,Ws)},r.id)}function Ws(r){return r.toUpperCase()}function Ys(r){switch(r){case"super_admin":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-100";case"admin":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100";case"content_editor":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100";case"academic_admin":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-100";case"admission_admin":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-100";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100"}}function Zs(r){q.post(`/admin/users/${r.id}/toggle-active`)}function et(r){return r.key}function st(r){return r.name}export{Yt as default};
